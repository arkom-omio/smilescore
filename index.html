<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SmileScore — оценка улыбки</title>
  <meta name="description" content="Локальное веб-приложение: позитивная оценка улыбки по фото. Ничего не отправляется на сервер." />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html,body,#root{height:100%} body{background:#0b0b0f}
    #err{position:fixed;inset:0;display:none;background:rgba(0,0,0,.92);color:#fff;padding:16px;z-index:99999;white-space:pre-wrap}
  </style>
</head>
<body>
  <div id="root"></div>
  <div id="err"></div>

  <script>
    addEventListener('error', e => {
      var el=document.getElementById('err'); el.textContent='JS error: '+(e&&e.message||e); el.style.display='block';
    });
    addEventListener('unhandledrejection', e => {
      var el=document.getElementById('err'); var r=e&&e.reason; el.textContent='Promise: '+(r&&(r.message||r)||e); el.style.display='block';
    });
  </script>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel" data-presets="env,react">
    /* ==== облегчённые "motion" стабы ==== */
    const AnimatePresence = ({ children }) => <>{children}</>;
    const motion = new Proxy({}, { get: (_t, tag) => (props) => React.createElement(tag, props) });
    /* ================================== */

    const { useEffect, useRef, useState } = React;
    const prettyDate = () => new Date().toLocaleString();
    const MAX_SIZE = 15 * 1024 * 1024;

    /* … весь код анализатора, DropZone, ScoreRing, Metric, Toast и т.д. остаётся без изменений … */

    function App(){
      const [file,setFile]=useState(null);
      const [imgURL,setImgURL]=useState(null);
      const [imgTooDark,setImgTooDark]=useState(false);
      const [score,setScore]=useState(null);
      const [metrics,setMetrics]=useState(null);
      const [busy,setBusy]=useState(false);
      const [autoAnalyze,setAutoAnalyze]=useState(true);
      const [history,setHistory]=useState([]);
      const [toast,setToast]=useState(null);

      /* … остальной функционал без изменений … */

      return (<div className={'min-h-screen text-white'}>
        {/* шапка */}
        <main className="mx-auto max-w-6xl px-4 py-10 md:py-16">
          <div className="mt-10 grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div className="space-y-4">
              {/* блок загрузки/фото */}
              {/* … этот кусок без изменений … */}

              {/* КНОПКИ */}
              <div className="flex flex-wrap items-center gap-3">
                <button onClick={handleAnalyze} disabled={!imgURL || busy}
                  className="rounded-2xl bg-white text-black px-5 py-3 text-sm font-medium shadow-lg disabled:opacity-40 disabled:cursor-not-allowed">
                  {busy?'Анализ…':'Оценить улыбку'}
                </button>

                <button onClick={exportPNG} disabled={!score || !imgURL}
                  className="rounded-2xl bg-white/10 hover:bg-white/20 px-4 py-3 text-sm disabled:opacity-40 disabled:cursor-not-allowed">
                  Сохранить PNG
                </button>

                <label className="flex items-center gap-2 text-white/70 text-sm select-none">
                  <input type="checkbox" checked={autoAnalyze} onChange={e=>setAutoAnalyze(e.currentTarget.checked)} className="accent-white"/> 
                  Авто-оценка после загрузки
                </label>
              </div>

              {/* история */}
              {/* … без изменений … */}
            </div>

            {/* правый блок с результатами */}
            {/* … без изменений … */}
          </div>
        </main>

        {toast && <Toast message={toast} onClose={()=>setToast(null)}/>}
      </div>);
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App/>);
  </script>
</body>
</html>
